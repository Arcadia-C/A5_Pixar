<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <title>Pixar Visualization</title>
    <script src="plots/d3.v7.min.js"></script>
    <style>
      .reveal-container {
        margin-top: 40px;
      }

      .hover-bar {
        width: 100%;
        background-color: rgba(255, 255, 255, 0.12);
        color: white;
        font-size: 26px;
        font-weight: bold;
        text-align: center;
        padding: 20px;
        margin: 40px 0 10px 0;
        border-top: 2px solid white;
        border-bottom: 2px solid white;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .hover-bar:hover {
        background-color: rgba(255, 255, 255, 0.25);
      }

      .viz-wrapper {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.8s ease;
      }

      .viz-wrapper.revealed {
        max-height: 800px; /* Adjust based on graph size */
      }

      #tooltip {
        position: absolute;
        background: white;
        color: black;
        border: 1px solid #ccc;
        padding: 5px 10px;
        font-size: 12px;
        pointer-events: none;
        opacity: 0;
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        pointer-events: auto;
      }

      /* Base slider styling */
      input[type="range"] {
        -webkit-appearance: none;
        width: 100%;
        height: 8px;
        border-radius: 5px;
        background: #ddd;
        outline: none;
      }

      /* Customize the track (for Chrome, Safari) */
      #boxWeight::-webkit-slider-runnable-track {
        background: green;
      }

      #openingWeight::-webkit-slider-runnable-track {
        background: green;
      }

      #rottenWeight::-webkit-slider-runnable-track {
        background: red;
      }

      #imdbWeight::-webkit-slider-runnable-track {
        background: yellow;
      }

      #metacriticWeight::-webkit-slider-runnable-track {
        background: orange;
      }

      #originalityWeight::-webkit-slider-runnable-track {
        background: purple;
      }

      #awardsWeight::-webkit-slider-runnable-track {
        background: blue;
      }

      /* Make thumbs stand out a bit */
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 12px;
        height: 12px;
        background: white;
        border: 2px solid #888;
        border-radius: 50%;
        cursor: pointer;
        margin-top: 0 px; /* centers thumb vertically */
      }
    </style>
  </head>

  <body>
    <div class="content">
      <h1>Has Pixar Lost Its Magic?</h1>
      <h3>
        Exploring the Evolution of Pixar Films and the Changing Landscape of
        Animated Storytelling.
      </h3>
      <p>
        Not so long ago (in 1994 to be exact), on a hot day in California, there
        were four men having lunch at a frequented spot: The Hidden City Cafe.
        But this was no ordinary lunch. And they were no ordinary people. They
        were Pixar's directors and were brainstorming new ideas for their next
        movies. Given that they were wrapping up production on Toy Story (which
        would release the following year), they were buzzing with ideas of what
        to do next. From the small-scaled story of a Bug's Life to the gigantic
        tale of Monster's Inc, several narratives were born in the fabled "$2
        Billion Lunch Meeting".
      </p>
      <p>
        The last idea they came up with was WALL-E, which would release in 2008.
      </p>

      <div class="video-container">
        <iframe
          width="700"
          height="1700"
          src="https://www.youtube.com/embed/ggV082dBgcY"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        >
        </iframe>
      </div>

      <p>
        But there's a problem when it comes to this teaser trailer: doesn't it
        seem like everything after WALL-E was an afterthought?
      </p>
      <p>
        Thus, one way to divide the Pixar timeline are "pre-WALL-E" films and
        "post-WALL-E" films (with the dividing line being at 2008). Many people
        believe that all the "pre-WALL-E" films are the greatest of Pixar's
        work, whereas those after it were... well an afterthought (except for
        maybe the first 15 minutes of Up).
      </p>
      <p>
        But are they right? Is there a way to tell if there is a decline in
        Pixar films after 2008? Or more generally...
      </p>
      <h3>
        Is Pixar's perceived decline unique, or part of broader industry trends?
      </h3>
      <p>
        We could conclude that Pixar films are getting worse, but that doesn't
        mean much if the general state of cinema is in decline. To mitigate
        this, some of our metrics will have comparison "baselines" to illustrate
        what the "standard" value of the metric was at the time.
      </p>
      <div class="container">
        <div class="controls">
          <label for="window-size">Trend Line Window:</label>
          <select id="window-size">
            <option value="3">3 Years</option>
            <option value="5">5 Years</option>
            <option value="7">7 Years</option>
          </select>
        </div>

        <div id="chart-container"></div>
      </div>
      <br /><br />
      <h3>Has perception of Pixar films gotten worse?</h3>
      <p>To see if this is the case, we will dive into several metrics:</p>
      <ul>
        <li>1. Originality</li>
        <li>2. Box Office Returns</li>
        <li>3. Audience Reception</li>
        <li>4. Critical Acclaim</li>
        <li>5. Artists Involved In The Movies</li>
      </ul>
      <p>
        And at the very end, we'll let YOU decide which of these factors are
        important! Play with the bars that correspond to the influence each
        factor has in the final graph.
      </p>
      <p>
        You can also click on the bars to see more details about each movie!
      </p>
      <p>
        But before we get into the Pixar movie metrics, we have another question
        to address:
      </p>
      <br />
      <div class="reveal-container">
        <!-- Box Office Section -->
        <div class="hover-bar" id="revealBoxOffice">Box Office</div>
        <div id="visualization-wrapper-boxoffice" class="viz-wrapper">
          <div id="visualization"></div>
        </div>

        <!-- Originality Section -->
        <div class="hover-bar" id="revealOriginality">Originality</div>
        <div id="visualization-wrapper-originality" class="viz-wrapper">
          <div id="originality"></div>
        </div>

        <!-- Critical Reception Section -->
        <div class="hover-bar" id="revealCritical">Critical Reception</div>
        <div id="visualization-wrapper-critical" class="viz-wrapper">
          <div id="critical"></div>
          <input
            type="checkbox"
            class="awardCategory"
            id="originalScreenplay"
            checked
          />
          <label for="originalScreenplay">Original Screenplay</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="animatedFeature"
            checked
          />
          <label for="animatedFeature">Animated Feature</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="originalScore"
            checked
          />
          <label for="originalScore">Original Score</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="originalSong"
            checked
          />
          <label for="originalSong">Original Song</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="soundEditing"
            checked
          />
          <label for="soundEditing">Sound Editing</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="soundMixing"
            checked
          />
          <label for="soundMixing">Sound Mixing</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="bestPicture"
            checked
          />
          <label for="bestPicture">Best Picture</label>
          <input
            type="checkbox"
            class="awardCategory"
            id="adaptedScreenplay"
            checked
          />
          <label for="adaptedScreenplay">Adapted Screenplay</label>
        </div>

        <!-- Audience Reception Section -->
        <div class="hover-bar" id="revealAudience">Audience Reception</div>
        <div id="visualization-wrapper-audience" class="viz-wrapper">
          <div id="audience-chart"></div>
        </div>

        <!-- You Decide Section -->
        <div class="hover-bar" id="revealYouDecide">You Decide</div>
        <div id="visualization-wrapper-youdecide" class="viz-wrapper">
          <div style="display: flex">
            <div style="display: flex">
              <div id="you-decide-viz" style="flex: 3; min-width: 700px"></div>
              <div
                id="you-decide-controls"
                style="
                  flex: 0 0 300px; /* always 300 px wide */
                  margin-left: 20px;
                  max-height: 580px; /* same as chart height minus some padding */
                  overflow-y: auto; /* vertical scroll if content is taller */
                "
              ></div>
            </div>
          </div>
        </div>
      </div>

      <div style="height: 2000px"></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script type="module" src="plots/index_script.js"></script>
    <script type="module" src="plots/originality.js"></script>
    <script type="module" src="plots/you_decide.js"></script>
    <script type="module" src="plots/critical_reception.js"></script>
    <script type="module" src="plots/pixar_dreamworks.js"></script>
    <script type="module" src="plots/audience_reception.js"></script>

    <div
      id="tooltip"
      style="
        position: absolute;
        background: white;
        border: 1px solid #ccc;
        padding: 5px 10px;
        font-size: 12px;
        pointer-events: none;
        opacity: 0;
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
      "
    ></div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const toggleReveal = (barId, wrapperId) => {
          const bar = document.getElementById(barId);
          const wrapper = document.getElementById(wrapperId);

          if (bar && wrapper) {
            bar.addEventListener("click", () => {
              wrapper.classList.toggle("revealed");
            });
          }
        };

        toggleReveal("revealBoxOffice", "visualization-wrapper-boxoffice");
        toggleReveal("revealOriginality", "visualization-wrapper-originality");
        toggleReveal("revealYouDecide", "visualization-wrapper-youdecide");
        toggleReveal("revealCritical", "visualization-wrapper-critical");
        toggleReveal("revealAudience", "visualization-wrapper-audience");
      });
      document
        .getElementById("window-size")
        .addEventListener("change", function () {
          const windowSize = parseInt(this.value);
          document.getElementById("window-size-text").textContent = windowSize;

          // Clear previous chart
          document.getElementById("chart-container").innerHTML = "";

          // Re-load the chart with the new window size
          // The main JS file will read this value when creating the chart
          // d3.csv("data/merged_movie_data.csv").then((data) => {
          //   // The main chart code will run again from pixar-dreamworks-chart.js
          // }).catch(error => {
          //   console.error('Error reloading data:', error);
          // });
        });
    </script>
  </body>
</html>
